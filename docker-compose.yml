services:
    builder:
        build:
            context: .
            dockerfile: Dockerfile
            args:
                - VITE_SUPABASE_URL=${VITE_SUPABASE_URL}
                - VITE_SUPABASE_ANON_KEY=${VITE_SUPABASE_ANON_KEY}
                - VITE_FRONTEND_URL=${VITE_FRONTEND_URL}
        volumes:
            - dist-data:/app/dist

    nginx:
        image: nginx:alpine
        expose:
            - 80
        volumes:
            - ./nginx.conf:/etc/nginx/nginx.conf
            - dist-data:/usr/share/nginx/html
        depends_on:
            - builder

volumes:
    dist-data:
